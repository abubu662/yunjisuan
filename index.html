<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>商店交易数据分析系统 - HBase真实数据</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        h1 {
            font-size: 24px;
            color: #2c3e50;
        }

        .time-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .time-input {
            display: flex;
            align-items: center;
            margin: 0 10px;
        }

        .time-input label {
            margin-right: 8px;
            font-weight: bold;
        }

        .time-input input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .buttons {
            display: flex;
            gap: 10px;
        }

        button {
            padding: 8px 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #2980b9;
        }

        .chart-container {
            margin-bottom: 30px;
            background-color: white;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
        }

        .chart-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: #2c3e50;
            border-left: 4px solid #3498db;
            padding-left: 10px;
        }

        .chart-wrapper {
            position: relative;
            height: 300px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        table,
        th,
        td {
            border: 1px solid #ddd;
        }

        th,
        td {
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .legend {
            display: flex;
            justify-content: center;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 0 10px;
        }

        .legend-color {
            width: 15px;
            height: 15px;
            margin-right: 5px;
        }

        .stats-info {
            display: flex;
            justify-content: center;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .stat-item {
            margin: 0 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #3498db;
        }

        .stat-label {
            font-size: 14px;
            color: #7f8c8d;
        }

        @media (max-width: 768px) {
            .time-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .time-input {
                margin: 5px 0;
            }

            .buttons {
                justify-content: center;
                margin-top: 10px;
            }

            .chart-wrapper {
                height: 250px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>商店交易数据分析系统 - HBase真实数据</h1>
        </header>

        <div class="time-controls">
            <div class="time-input">
                <label for="start-time">开始时间：</label>
                <input type="datetime-local" id="start-time" value="2024-10-21T00:00">
            </div>
            <div class="time-input">
                <label for="end-time">结束时间：</label>
                <input type="datetime-local" id="end-time" value="2024-10-21T23:59">
            </div>
            <div class="buttons">
                <button id="query-btn">查询时间段</button>
                <button id="show-all-btn">显示全部数据</button>
            </div>
        </div>

        <div class="chart-container">
            <h2 class="chart-title">商品类别销售统计 (HBase真实数据)</h2>
            <div class="chart-wrapper">
                <canvas id="categoryChart"></canvas>
            </div>
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #3498db;"></div>
                    <span>销售额</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #2ecc71;"></div>
                    <span>交易数量</span>
                </div>
            </div>
            <div class="stats-info">
                <div class="stat-item">
                    <div class="stat-value">¥6,847</div>
                    <div class="stat-label">电子产品销售额</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">4</div>
                    <div class="stat-label">交易数量</div>
                </div>
            </div>
        </div>

        <div class="chart-container">
            <h2 class="chart-title">销售额时间分布 (HBase真实数据)</h2>
            <div class="chart-wrapper">
                <canvas id="timeDistributionChart"></canvas>
            </div>
        </div>

        <div class="chart-container">
            <h2 class="chart-title">价格统计概览 (HBase真实数据)</h2>
            <div class="chart-wrapper">
                <canvas id="priceChart"></canvas>
            </div>
        </div>

        <div class="chart-container">
            <h2 class="chart-title">交易数据明细 (HBase真实数据)</h2>
            <table>
                <thead>
                    <tr>
                        <th>商品ID</th>
                        <th>交易时间</th>
                        <th>商品类别</th>
                        <th>价格</th>
                    </tr>
                </thead>
                <tbody id="transaction-table">
                    <!-- 数据将通过JavaScript填充 -->
                </tbody>
            </table>
            <p style="margin-top: 10px; text-align: center;">共10条记录</p>
        </div>
    </div>

    <script>
        // 交易数据
        const transactionData = [
            { id: 'GOODS_001', time: '2024-10-21 08:30:00', category: '电子产品', price: 2999.00 },
            { id: 'GOODS_002', time: '2024-10-21 09:15:25', category: '日用品', price: 39.00 },
            { id: 'GOODS_003', time: '2024-10-21 10:05:10', category: '食物', price: 8.50 },
            { id: 'GOODS_004', time: '2024-10-21 11:45:30', category: '日用品', price: 520.00 },
            { id: 'GOODS_005', time: '2024-10-21 13:20:15', category: '电子产品', price: 1899.00 },
            { id: 'GOODS_006', time: '2024-10-21 14:55:40', category: '食物', price: 4.50 },
            { id: 'GOODS_007', time: '2024-10-21 15:40:00', category: '日用品', price: 25.00 },
            { id: 'GOODS_008', time: '2024-10-21 16:10:55', category: '电子产品', price: 1250.00 },
            { id: 'GOODS_009', time: '2024-10-21 17:30:20', category: '食物', price: 12.80 },
            { id: 'GOODS_010', time: '2024-10-21 18:05:10', category: '电子产品', price: 699.00 }
        ];

        // 填充交易数据表格
        function populateTransactionTable() {
            const tableBody = document.getElementById('transaction-table');
            tableBody.innerHTML = '';

            transactionData.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.id}</td>
                    <td>${item.time}</td>
                    <td>${item.category}</td>
                    <td>¥${item.price.toFixed(2)}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // 计算商品类别统计数据
        function calculateCategoryStats() {
            const categories = {};

            transactionData.forEach(item => {
                if (!categories[item.category]) {
                    categories[item.category] = {
                        sales: 0,
                        count: 0
                    };
                }

                categories[item.category].sales += item.price;
                categories[item.category].count += 1;
            });

            return categories;
        }

        // 计算销售额时间分布
        function calculateTimeDistribution() {
            const hours = Array(24).fill(0);

            transactionData.forEach(item => {
                const hour = parseInt(item.time.split(' ')[1].split(':')[0]);
                hours[hour] += item.price;
            });

            return hours;
        }

        // 计算价格统计数据
        function calculatePriceStats() {
            const prices = transactionData.map(item => item.price);
            const maxPrice = Math.max(...prices);
            const minPrice = Math.min(...prices);
            const avgPrice = prices.reduce((sum, price) => sum + price, 0) / prices.length;

            return { maxPrice, minPrice, avgPrice };
        }

        // 初始化图表
        function initCharts() {
            const categoryStats = calculateCategoryStats();
            const timeDistribution = calculateTimeDistribution();
            const priceStats = calculatePriceStats();

            // 商品类别销售统计图表
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            new Chart(categoryCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(categoryStats),
                    datasets: [
                        {
                            label: '销售额',
                            data: Object.values(categoryStats).map(stat => stat.sales),
                            backgroundColor: '#3498db',
                            yAxisID: 'y'
                        },
                        {
                            label: '交易数量',
                            data: Object.values(categoryStats).map(stat => stat.count),
                            type: 'line',
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: '销售额 (元)'
                            },
                            ticks: {
                                callback: function (value) {
                                    return '¥' + value.toLocaleString();
                                }
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: '交易数量'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        }
                    }
                }
            });

            // 销售额时间分布图表
            const timeCtx = document.getElementById('timeDistributionChart').getContext('2d');
            new Chart(timeCtx, {
                type: 'line',
                data: {
                    labels: Array.from({ length: 24 }, (_, i) => i + '时'),
                    datasets: [{
                        label: '销售额',
                        data: timeDistribution,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '销售额 (元)'
                            },
                            ticks: {
                                callback: function (value) {
                                    return '¥' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });

            // 价格统计概览图表
            const priceCtx = document.getElementById('priceChart').getContext('2d');
            new Chart(priceCtx, {
                type: 'pie',
                data: {
                    labels: ['最高价格', '平均价格', '最低价格'],
                    datasets: [{
                        data: [priceStats.maxPrice, priceStats.avgPrice, priceStats.minPrice],
                        backgroundColor: ['#3498db', '#2ecc71', '#f1c40f']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return context.label + ': ¥' + context.raw.toFixed(2);
                                }
                            }
                        }
                    }
                }
            });
        }

        // 初始化页面
        document.addEventListener('DOMContentLoaded', function () {
            populateTransactionTable();
            initCharts();

            // 添加按钮事件监听
            document.getElementById('query-btn').addEventListener('click', function () {
                alert('查询时间段功能已触发，实际应用中会调用后端API获取数据');
            });

            document.getElementById('show-all-btn').addEventListener('click', function () {
                alert('显示全部数据功能已触发，实际应用中会重置过滤器显示所有数据');
            });
        });
    </script>
</body>

</html>